!function e(n,t,r){function s(i,u){if(!t[i]){if(!n[i]){var c="function"==typeof require&&require;if(!u&&c)return c(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var d=t[i]={exports:{}};n[i][0].call(d.exports,function(e){var t=n[i][1][e];return s(t?t:e)},d,d.exports,e,n,t,r)}return t[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)s(r[i]);return s}({1:[function(e,n,t){"use strict";var r=e("./standardize.js"),s=e("./websocket/index.js"),o=e("./options.js"),i=function(e,n){o.initialize(n);var t={create:function(n,r){return t.wrap(new e(n,r))},wrap:function(e){var n=s(r(e));return n.onMessage(function(e){}),n.onClose(function(e,n){}),n}};return t};"undefined"!=typeof window&&(window.Rapport=i),"undefined"!=typeof n&&(n.exports=i)},{"./options.js":2,"./standardize.js":4,"./websocket/index.js":10}],2:[function(e,n,t){"use strict";var r={initialize:function(e){e&&(e.stringify&&(r.stringify=e.stringify),e.parse&&(r.parse=e.parse),e.Promise&&(r.Promise=e.Promise),e.generateRequestId&&(r.generateRequestId=e.generateRequestId))},stringify:JSON.stringify,parse:JSON.parse,Promise:"undefined"!=typeof Promise?Promise:null,generateRequestId:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=Date.now(),t=(n+16*Math.random())%16|0;return("x"===e?t:3&t|8).toString(16)})}};n.exports=r},{}],3:[function(e,n,t){"use strict";var r=e("./util.js"),s={},o={addCallback:function(e,n){s[e]={cb:n}},addPromise:function(e,n,t){s[e]={resolve:n,reject:t}},resolve:function(e,n){s[e]&&(s[e].cb?s[e].cb(n):s[e].resolve(n),delete s[e])},reject:function(e,n){s[e]&&(s[e].cb?s[e].cb(null,n):s[e].reject(n),delete s[e])},rejectAll:function(e,n){Object.keys(s).forEach(function(t){o.reject(t,new Error("Websocket has been closed: "+e+" - "+r.stringify(n)))})}};n.exports=o},{"./util.js":5}],4:[function(e,n,t){"use strict";var r=function(e){return{onOpen:function(n){e.onopen=n},onClose:function(n){e.onclose=n},onError:function(n){e.onerror=n},onMessage:function(n){e.onmessage=function(e){n(e.data)}},send:e.send.bind(e),close:e.close.bind(e)}},s=function(e){function n(n,t){e.removeAllListeners(n),e.on(n,t)}return{onOpen:n.bind(null,"open"),onClose:n.bind(null,"close"),onError:n.bind(null,"error"),onMessage:n.bind(null,"message"),send:e.send.bind(e),close:e.close.bind(e)}};n.exports=function(e){return e.on?s(e):r(e)}},{}],5:[function(e,n,t){"use strict";var r=e("./options.js"),s={stringify:function(e){return"string"==typeof e?e:r.stringify(e)},parse:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof e)try{return r.parse(e)}catch(e){if(n)return n;throw e}return e}};n.exports=s},{"./options.js":2}],6:[function(e,n,t){"use strict";var r=e("../util.js"),s=e("../request.cache.js");n.exports=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Socket was closed locally",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;s.rejectAll(t,n),e.close(t,r.stringify(n))}},{"../request.cache.js":3,"../util.js":5}],7:[function(e,n,t){"use strict";n.exports=function(e,n,t,r,s){return e.http("delete",n,t,r,s)}},{}],8:[function(e,n,t){"use strict";n.exports=function(e,n,t,r,s){return e.http("get",n,t,r,s)}},{}],9:[function(e,n,t){"use strict";n.exports=function(e,n,t,r,s,o){return e.request({verb:n,route:t,body:r},s,o)}},{}],10:[function(e,n,t){"use strict";n.exports=function(n){var t={};return t.send=e("./send.js").bind(null,n),t.close=e("./close.js").bind(null,n),t.request=e("./request.js").bind(null,t),t.respond=e("./respond.js").bind(null,t),t.respondWithError=e("./respond.with.error.js").bind(null,t),t.http=e("./http.js").bind(null,t),t.get=e("./get.js").bind(null,t),t.post=e("./post.js").bind(null,t),t.put=e("./put.js").bind(null,t),t.patch=e("./patch.js").bind(null,t),t.delete=e("./delete.js").bind(null,t),t.onOpen=n.onOpen,t.onError=n.onError,t.onMessage=e("./on.message.js").bind(null,n,t),t.onClose=e("./on.close.js").bind(null,n),t}},{"./close.js":6,"./delete.js":7,"./get.js":8,"./http.js":9,"./on.close.js":11,"./on.message.js":12,"./patch.js":13,"./post.js":14,"./put.js":15,"./request.js":16,"./respond.js":17,"./respond.with.error.js":18,"./send.js":19}],11:[function(e,n,t){"use strict";var r=e("../util.js"),s=e("../request.cache.js");n.exports=function(e,n){e.onClose(function(e,t){var o=r.parse(t,t);s.rejectAll(e,o),n(o,e)})}},{"../request.cache.js":3,"../util.js":5}],12:[function(e,n,t){"use strict";var r=e("../util.js"),s=e("../request.cache.js"),o=function(e,n,t){n?s.resolve(e,n):t?s.reject(e,t):s.reject(e,new Error("Got a response object without a response or error property"))},i=function(e,n,t,r){r(t,{requestId:n,shouldRespond:!0,respond:e.respond.bind(null,n),respondWithError:e.respondWithError.bind(null,n),send:e.send})},u=function(e,n,t){t(n,{shouldRespond:!1,send:e.send})};n.exports=function(e,n,t){e.onMessage(function(e){var s=void 0;try{s=r.parse(e)}catch(e){return void n.send(e)}s.responseId?o(s.responseId,s.response,s.error):s.requestId?i(n,s.requestId,s.request,t):u(n,s,t)})}},{"../request.cache.js":3,"../util.js":5}],13:[function(e,n,t){"use strict";n.exports=function(e,n,t,r,s){return e.http("patch",n,t,r,s)}},{}],14:[function(e,n,t){"use strict";n.exports=function(e,n,t,r,s){return e.http("post",n,t,r,s)}},{}],15:[function(e,n,t){"use strict";n.exports=function(e,n,t,r,s){return e.http("put",n,t,r,s)}},{}],16:[function(e,n,t){"use strict";var r=e("../options.js"),s=e("../request.cache.js");n.exports=function(e,n,t,o){var i={requestId:r.generateRequestId(),request:n};if(t&&setTimeout(function(){s.reject(i.requestId,new Error("Timed out after "+t+" ms"))},t),!o){if(r.Promise)return new r.Promise(function(n,t){s.addPromise(i.requestId,n,t),e.send(i)});throw new Error("Can\t make a request without a Promise implementation or callback")}s.addCallback(i.requestId,o),e.send(i)}},{"../options.js":2,"../request.cache.js":3}],17:[function(e,n,t){"use strict";n.exports=function(e,n,t){e.send({responseId:n,response:t})}},{}],18:[function(e,n,t){"use strict";n.exports=function(e,n,t){e.send({responseId:n,error:t})}},{}],19:[function(e,n,t){"use strict";var r=e("../util.js");n.exports=function(e,n){e.send(r.stringify(n))}},{"../util.js":5}]},{},[1]);
